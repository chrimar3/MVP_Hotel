<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1e40af">
    <title>ğŸ¨ Hotel Review Generator - Ultimate UX v3</title>
    
    <!-- Performance: Preload Critical Resources -->
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    
    <!-- Preload critical fonts if using web fonts -->
    <link rel="preload" as="style" href="data:text/css;charset=UTF-8," onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js" defer></script>
    
    <style>
        /* Enhanced CSS Variables */
        :root {
            --primary: #1e40af;
            --primary-dark: #1e3a8a;
            --primary-light: #3b82f6;
            --success: #059669;
            --error: #dc2626;
            --warning: #d97706;
            --text: #1f2937;
            --text-light: #6b7280;
            --bg: #ffffff;
            --bg-light: #f9fafb;
            --bg-elevated: #ffffff;
            --border: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --touch-target: 48px;
            --max-width: 480px;
            --border-radius: 0.5rem;
            --transition-fast: 150ms;
            --transition-normal: 300ms;
            --transition-slow: 500ms;
            --animation-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #3b82f6;
                --primary-dark: #2563eb;
                --primary-light: #60a5fa;
                --success: #10b981;
                --error: #ef4444;
                --warning: #f59e0b;
                --text: #f3f4f6;
                --text-light: #9ca3af;
                --bg: #111827;
                --bg-light: #0f172a;
                --bg-elevated: #1f2937;
                --border: #374151;
            }
        }

        /* Micro-animations */
        @keyframes buttonPress {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        @keyframes checkmark {
            0% { 
                stroke-dashoffset: 100;
                opacity: 0;
            }
            50% { opacity: 1; }
            100% { 
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        /* Skeleton Loader */
        .skeleton {
            background: linear-gradient(
                90deg,
                var(--border) 25%,
                var(--bg-light) 50%,
                var(--border) 75%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: var(--border-radius);
        }

        .skeleton-text {
            height: 1rem;
            margin: 0.5rem 0;
            border-radius: 0.25rem;
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: var(--bg-light);
            color: var(--text);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        /* Container */
        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 1rem;
            min-height: 100vh;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 2rem 0 1rem;
            position: relative;
            animation: fadeIn 0.5s ease-out;
        }

        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        /* Language Selector */
        .language-selector {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .lang-btn {
            padding: 0.25rem 0.5rem;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .lang-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Progressive Form Sections */
        .form-section {
            background: var(--bg-elevated);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            animation: slideInUp 0.3s ease-out;
        }

        .form-section.hidden {
            display: none;
        }

        .form-section.revealing {
            animation: slideInUp 0.4s var(--animation-bounce);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            font-size: 1rem;
            background: var(--bg);
            color: var(--text);
            transition: all var(--transition-fast);
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Review Length Indicator */
        .length-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            transition: all var(--transition-fast);
        }

        .length-indicator.perfect {
            color: var(--success);
        }

        .length-indicator.good {
            color: var(--primary);
        }

        .length-indicator.warning {
            color: var(--warning);
        }

        .length-indicator.error {
            color: var(--error);
        }

        .length-bar {
            flex: 1;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
        }

        .length-fill {
            height: 100%;
            transition: all var(--transition-normal);
            border-radius: 2px;
        }

        /* Validation Indicator */
        .validation-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: var(--border-radius);
            margin-top: 0.5rem;
            font-size: 0.875rem;
            transition: all var(--transition-fast);
        }

        .validation-indicator.valid {
            background: rgba(5, 150, 105, 0.1);
            color: var(--success);
        }

        .validation-indicator.invalid {
            background: rgba(220, 38, 38, 0.1);
            color: var(--error);
        }

        .validation-checkmark {
            width: 20px;
            height: 20px;
        }

        .validation-checkmark svg {
            stroke: currentColor;
            stroke-width: 3;
            fill: none;
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: checkmark 0.5s ease-out forwards;
        }

        /* Aspect Cards with Micro-animations */
        .aspects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .aspect-card {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            padding: 1rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: var(--touch-target);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .aspect-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .aspect-card:active {
            animation: buttonPress 0.2s ease-out;
        }

        .aspect-card.selected {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        /* Buttons with Micro-animations */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            min-height: var(--touch-target);
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .btn:active {
            animation: buttonPress 0.2s ease-out;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Sharing Section */
        .sharing-section {
            background: var(--bg-elevated);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: var(--shadow-md);
            animation: slideInUp 0.3s ease-out;
        }

        .sharing-section.hidden {
            display: none;
        }

        .sharing-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .qr-container {
            text-align: center;
            padding: 1rem;
            background: var(--bg);
            border-radius: var(--border-radius);
            border: 1px solid var(--border);
        }

        .qr-code {
            max-width: 120px;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
        }

        .share-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 600;
            font-size: 0.875rem;
            min-height: var(--touch-target);
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .share-btn:active {
            animation: buttonPress 0.2s ease-out;
        }

        .share-whatsapp {
            background: #25D366;
            color: white;
        }

        .share-facebook {
            background: #1877F2;
            color: white;
        }

        .share-twitter {
            background: #1DA1F2;
            color: white;
        }

        .share-email {
            background: var(--text);
            color: var(--bg);
        }

        .share-copy {
            background: var(--primary);
            color: white;
        }

        .share-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding: 0.75rem;
            background: var(--bg);
            border-radius: var(--border-radius);
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .share-counter {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .copy-success {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(5, 150, 105, 0.9);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            opacity: 0;
            transition: opacity var(--transition-fast);
        }

        .copy-success.show {
            opacity: 1;
        }

        /* Platform Submit Buttons */
        .platform-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
            animation: slideInUp 0.4s ease-out;
        }

        .platform-submit-btn {
            padding: 0.75rem;
            border: none;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .platform-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .platform-submit-btn:active {
            animation: buttonPress 0.2s ease-out;
        }

        .platform-booking { background: #003580; }
        .platform-google { background: #4285f4; }
        .platform-tripadvisor { background: #00AF87; }
        .platform-expedia { background: #3A5F8B; }

        /* Output Section */
        .output-section {
            background: var(--bg-elevated);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-top: 1rem;
            box-shadow: var(--shadow-md);
            animation: slideInUp 0.3s ease-out;
        }

        .output-section.hidden {
            display: none;
        }

        .review-output {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin: 1rem 0;
            white-space: pre-wrap;
            line-height: 1.6;
            color: var(--text);
            position: relative;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-elevated);
            color: var(--text);
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            animation: slideInUp 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            max-width: calc(100% - 2rem);
        }

        /* Loading States */
        .loading {
            display: inline-block;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .aspects-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .platform-buttons {
                grid-template-columns: 1fr;
            }

            .sharing-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .qr-container {
                order: 2;
            }

            .share-options {
                order: 1;
            }
        }

        /* Print Styles */
        @media print {
            .btn,
            .platform-buttons,
            .language-selector,
            .sharing-section {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header with Language Selector -->
        <header class="header">
            <div class="language-selector" id="language-selector">
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="es">ES</button>
                <button class="lang-btn" data-lang="fr">FR</button>
                <button class="lang-btn" data-lang="de">DE</button>
                <button class="lang-btn" data-lang="it">IT</button>
                <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
                <button class="lang-btn" data-lang="el">Î•Î›</button>
            </div>
            <h1 data-i18n="title">ğŸ¨ Hotel Review Generator</h1>
            <p data-i18n="subtitle">Create authentic reviews in seconds</p>
        </header>

        <!-- Progressive Form Section 1: Hotel Name -->
        <div class="form-section" id="hotel-section">
            <div class="form-group">
                <label for="hotel-name" data-i18n="hotelName">Hotel Name</label>
                <input 
                    type="text" 
                    id="hotel-name" 
                    placeholder="e.g., Grand Plaza Hotel" 
                    data-i18n-placeholder="hotelPlaceholder"
                    autocomplete="organization"
                    inputmode="text"
                    enterkeyhint="next"
                    spellcheck="true"
                    aria-label="Hotel name input"
                    aria-required="true"
                >
            </div>
        </div>

        <!-- Progressive Form Section 2: Aspects (Initially Hidden) -->
        <div class="form-section hidden" id="aspects-section">
            <div class="form-group">
                <label data-i18n="aspects">What You Loved</label>
                <div class="aspects-grid" id="aspects-grid">
                    <div class="aspect-card" data-aspect="Clean Rooms" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ§¹</span>
                        <span class="label" data-i18n="cleanRooms">Clean Rooms</span>
                    </div>
                    <div class="aspect-card" data-aspect="Friendly Staff" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ˜Š</span>
                        <span class="label" data-i18n="friendlyStaff">Friendly Staff</span>
                    </div>
                    <div class="aspect-card" data-aspect="Great Location" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ“</span>
                        <span class="label" data-i18n="greatLocation">Great Location</span>
                    </div>
                    <div class="aspect-card" data-aspect="Comfortable Beds" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ›ï¸</span>
                        <span class="label" data-i18n="comfortable">Comfortable</span>
                    </div>
                    <div class="aspect-card" data-aspect="Delicious Breakfast" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ³</span>
                        <span class="label" data-i18n="breakfast">Breakfast</span>
                    </div>
                    <div class="aspect-card" data-aspect="Excellent Value" tabindex="0" role="button" aria-pressed="false">
                        <span class="emoji">ğŸ’°</span>
                        <span class="label" data-i18n="value">Great Value</span>
                    </div>
                </div>
            </div>
            
            <!-- Staff Recognition Section (Optional) -->
            <div class="form-group" style="margin-top: 20px;">
                <label for="staff-recognition" style="display: flex; align-items: center; gap: 8px;">
                    <span>ğŸ‘</span>
                    <span data-i18n="staffRecognition">Staff Recognition (Optional)</span>
                </label>
                <input 
                    type="text" 
                    id="staff-recognition" 
                    placeholder="Name any staff member who provided excellent service"
                    data-i18n-placeholder="staffPlaceholder"
                    autocomplete="off"
                    inputmode="text"
                    enterkeyhint="next"
                    spellcheck="true"
                    autocorrect="on"
                    autocapitalize="words"
                    aria-label="Staff recognition"
                    style="margin-top: 8px;"
                />
                <div style="font-size: 0.85rem; color: var(--text-light); margin-top: 4px;">
                    <span data-i18n="staffHint">Mentioning staff by name helps them get recognized!</span>
                </div>
            </div>
        </div>

        <!-- Progressive Form Section 3: Comments (Initially Hidden) -->
        <div class="form-section hidden" id="comments-section">
            <div class="form-group">
                <label for="comments" data-i18n="comments">Additional Comments (Optional)</label>
                <textarea 
                    id="comments" 
                    rows="3" 
                    placeholder="Any specific details..." 
                    data-i18n-placeholder="commentsPlaceholder"
                    autocomplete="off"
                    inputmode="text"
                    enterkeyhint="done"
                    spellcheck="true"
                    autocorrect="on"
                    autocapitalize="sentences"
                    aria-label="Additional comments"
                ></textarea>
                <div class="length-indicator" id="length-indicator">
                    <span id="length-text"></span>
                    <div class="length-bar">
                        <div class="length-fill" id="length-fill"></div>
                    </div>
                </div>
            </div>
            
            <!-- Generate Button -->
            <button id="generate-btn" class="btn btn-primary" aria-label="Generate review">
                <span data-i18n="generate">Generate Review</span>
                <span>âœ¨</span>
            </button>
        </div>

        <!-- Output Section (Initially Hidden) -->
        <div id="output-section" class="output-section hidden">
            <h3 data-i18n="yourReview">Your Review</h3>
            
            <!-- Validation Indicator -->
            <div class="validation-indicator hidden" id="validation-indicator">
                <div class="validation-checkmark">
                    <svg viewBox="0 0 24 24">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                </div>
                <span id="validation-text"></span>
            </div>
            
            <div id="review-output" class="review-output"></div>
            
            <!-- Link Distribution System -->
            <div id="sharing-section" class="sharing-section hidden">
                <h4 data-i18n="shareReview">Share Your Review</h4>
                
                <div class="sharing-grid">
                    <div class="qr-container">
                        <p data-i18n="qrCode">QR Code</p>
                        <canvas id="qr-canvas" class="qr-code"></canvas>
                        <p data-i18n="qrInstructions">Scan to share</p>
                    </div>
                    
                    <div class="share-options">
                        <button class="share-btn share-whatsapp" id="share-whatsapp" aria-label="Share via WhatsApp">
                            <span>ğŸ’¬</span>
                            <span data-i18n="shareWhatsApp">WhatsApp</span>
                        </button>
                        
                        <button class="share-btn share-facebook" id="share-facebook" aria-label="Share on Facebook">
                            <span>ğŸ‘¥</span>
                            <span data-i18n="shareFacebook">Facebook</span>
                        </button>
                        
                        <button class="share-btn share-twitter" id="share-twitter" aria-label="Share on Twitter">
                            <span>ğŸ¦</span>
                            <span data-i18n="shareTwitter">Twitter</span>
                        </button>
                        
                        <button class="share-btn share-email" id="share-email" aria-label="Share via Email">
                            <span>ğŸ“§</span>
                            <span data-i18n="shareEmail">Email</span>
                        </button>
                        
                        <button class="share-btn share-copy" id="share-copy" aria-label="Copy link">
                            <span>ğŸ“‹</span>
                            <span data-i18n="copyLink">Copy Link</span>
                            <div class="copy-success" id="copy-success" data-i18n="linkCopied">âœ“ Copied!</div>
                        </button>
                    </div>
                </div>
                
                <div class="share-stats">
                    <div class="share-counter">
                        <span>ğŸ“Š</span>
                        <span data-i18n="shareCount">Shares:</span>
                        <span id="share-count">0</span>
                    </div>
                    <div class="share-counter">
                        <span>ğŸ‘ï¸</span>
                        <span data-i18n="viewCount">Views:</span>
                        <span id="view-count">0</span>
                    </div>
                </div>
            </div>
            
            <!-- Platform Submit Buttons -->
            <div class="platform-buttons" id="platform-buttons">
                <button class="platform-submit-btn platform-booking" data-platform="booking" aria-label="Submit to Booking.com">
                    <span>ğŸ“˜</span>
                    <span data-i18n="submitBooking">Post to Booking.com</span>
                </button>
                <button class="platform-submit-btn platform-google" data-platform="google" aria-label="Submit to Google">
                    <span>ğŸ”</span>
                    <span data-i18n="submitGoogle">Post to Google</span>
                </button>
                <button class="platform-submit-btn platform-tripadvisor" data-platform="tripadvisor" aria-label="Submit to TripAdvisor">
                    <span>ğŸ¦‰</span>
                    <span data-i18n="submitTripadvisor">Post to TripAdvisor</span>
                </button>
                <button class="platform-submit-btn platform-expedia" data-platform="expedia" aria-label="Submit to Expedia">
                    <span>âœˆï¸</span>
                    <span data-i18n="submitExpedia">Post to Expedia</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Screen Reader Announcements -->
    <div role="status" aria-live="polite" aria-atomic="true" class="sr-only" id="sr-announcements"></div>

    <script>
        /**
         * Hotel Review Generator v3
         * @description Enhanced with TDD-first approach and performance optimizations
         */
        class HotelReviewGeneratorV3 {
            constructor() {
                // State management
                this.selectedAspects = new Set();
                this.currentLanguage = 'en';
                this.formData = {};
                this.validationErrors = [];
                this.draftTimer = null;
                this.platformUrls = new Map(); // Cache for platform URLs
                this.shareData = {
                    trackingId: this.generateTrackingId(),
                    shareCount: 0,
                    viewCount: 0
                };
                
                // Translations (lazy-loaded)
                this.translations = {
                    en: {
                        title: 'ğŸ¨ Hotel Review Generator',
                        subtitle: 'Create authentic reviews in seconds',
                        hotelName: 'Hotel Name',
                        hotelPlaceholder: 'e.g., Grand Plaza Hotel',
                        aspects: 'What You Loved',
                        comments: 'Additional Comments (Optional)',
                        commentsPlaceholder: 'Any specific details...',
                        generate: 'Generate Review',
                        yourReview: 'Your Review',
                        submitBooking: 'Post to Booking.com',
                        submitGoogle: 'Post to Google',
                        submitTripadvisor: 'Post to TripAdvisor',
                        submitExpedia: 'Post to Expedia',
                        cleanRooms: 'Clean Rooms',
                        friendlyStaff: 'Friendly Staff',
                        greatLocation: 'Great Location',
                        comfortable: 'Comfortable',
                        breakfast: 'Breakfast',
                        value: 'Great Value',
                        perfectLength: 'Perfect length!',
                        addMoreDetail: 'Add a bit more detail',
                        greatDetail: 'Great detail!',
                        tooLong: 'Consider shortening',
                        validReview: 'Review ready to submit!',
                        invalidReview: 'Please fix the issues',
                        profanityDetected: 'Please remove inappropriate language',
                        tooShort: 'Review is too short (min 50 characters)',
                        missingHotelName: 'Consider mentioning the hotel name',
                        shareReview: 'Share Your Review',
                        qrCode: 'QR Code',
                        qrInstructions: 'Scan to share',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'Email',
                        copyLink: 'Copy Link',
                        shareCount: 'Shares:',
                        viewCount: 'Views:',
                        linkCopied: 'âœ“ Link copied!',
                        shareSuccess: 'Share successful!',
                        staffRecognition: 'Staff Recognition (Optional)',
                        staffPlaceholder: 'Name any staff member who provided excellent service',
                        staffHint: 'Mentioning staff by name helps them get recognized!'
                    },
                    es: {
                        title: 'ğŸ¨ Generador de ReseÃ±as',
                        subtitle: 'Crea reseÃ±as autÃ©nticas en segundos',
                        hotelName: 'Nombre del Hotel',
                        hotelPlaceholder: 'ej., Hotel Grand Plaza',
                        aspects: 'Lo que te encantÃ³',
                        comments: 'Comentarios Adicionales (Opcional)',
                        commentsPlaceholder: 'Detalles especÃ­ficos...',
                        generate: 'Generar ReseÃ±a',
                        yourReview: 'Tu ReseÃ±a',
                        submitBooking: 'Publicar en Booking.com',
                        submitGoogle: 'Publicar en Google',
                        submitTripadvisor: 'Publicar en TripAdvisor',
                        submitExpedia: 'Publicar en Expedia',
                        cleanRooms: 'Habitaciones Limpias',
                        friendlyStaff: 'Personal Amable',
                        greatLocation: 'Excelente UbicaciÃ³n',
                        comfortable: 'CÃ³modo',
                        breakfast: 'Desayuno',
                        value: 'Buen Precio',
                        shareReview: 'Comparte tu ReseÃ±a',
                        qrCode: 'CÃ³digo QR',
                        qrInstructions: 'Escanea para compartir',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'Email',
                        copyLink: 'Copiar Enlace',
                        shareCount: 'Compartidos:',
                        viewCount: 'Vistas:',
                        linkCopied: 'âœ“ Enlace copiado!',
                        shareSuccess: 'Â¡Compartido con Ã©xito!',
                        staffRecognition: 'Reconocimiento del Personal (Opcional)',
                        staffPlaceholder: 'Nombra a cualquier empleado que brindÃ³ un servicio excelente',
                        staffHint: 'Â¡Mencionar al personal por su nombre les ayuda a ser reconocidos!'
                    },
                    fr: {
                        title: 'ğŸ¨ GÃ©nÃ©rateur d\'Avis',
                        subtitle: 'CrÃ©ez des avis authentiques en secondes',
                        hotelName: 'Nom de l\'HÃ´tel',
                        hotelPlaceholder: 'ex., HÃ´tel Grand Plaza',
                        aspects: 'Ce que vous avez aimÃ©',
                        comments: 'Commentaires SupplÃ©mentaires (Optionnel)',
                        commentsPlaceholder: 'DÃ©tails spÃ©cifiques...',
                        generate: 'GÃ©nÃ©rer l\'Avis',
                        yourReview: 'Votre Avis',
                        submitBooking: 'Publier sur Booking.com',
                        submitGoogle: 'Publier sur Google',
                        submitTripadvisor: 'Publier sur TripAdvisor',
                        submitExpedia: 'Publier sur Expedia',
                        cleanRooms: 'Chambres Propres',
                        friendlyStaff: 'Personnel Sympathique',
                        greatLocation: 'Excellent Emplacement',
                        comfortable: 'Confortable',
                        breakfast: 'Petit-dÃ©jeuner',
                        value: 'Bon Rapport QualitÃ©-Prix',
                        perfectLength: 'Longueur parfaite !',
                        addMoreDetail: 'Ajoutez plus de dÃ©tails',
                        greatDetail: 'Excellents dÃ©tails !',
                        tooLong: 'Envisagez de raccourcir',
                        validReview: 'Avis prÃªt Ã  soumettre !',
                        invalidReview: 'Veuillez corriger les problÃ¨mes',
                        profanityDetected: 'Veuillez supprimer le langage inappropriÃ©',
                        tooShort: 'L\'avis est trop court (minimum 50 caractÃ¨res)',
                        missingHotelName: 'Envisagez de mentionner le nom de l\'hÃ´tel',
                        shareReview: 'Partagez votre Avis',
                        qrCode: 'Code QR',
                        qrInstructions: 'Scannez pour partager',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'Email',
                        copyLink: 'Copier le Lien',
                        shareCount: 'Partages:',
                        viewCount: 'Vues:',
                        linkCopied: 'âœ“ Lien copiÃ©!',
                        shareSuccess: 'PartagÃ© avec succÃ¨s!'
                    },
                    de: {
                        title: 'ğŸ¨ Bewertungsgenerator',
                        subtitle: 'Erstellen Sie authentische Bewertungen in Sekunden',
                        hotelName: 'Hotelname',
                        hotelPlaceholder: 'z.B., Grand Plaza Hotel',
                        aspects: 'Was Ihnen gefallen hat',
                        comments: 'ZusÃ¤tzliche Kommentare (Optional)',
                        commentsPlaceholder: 'Spezifische Details...',
                        generate: 'Bewertung Generieren',
                        yourReview: 'Ihre Bewertung',
                        submitBooking: 'Auf Booking.com verÃ¶ffentlichen',
                        submitGoogle: 'Auf Google verÃ¶ffentlichen',
                        submitTripadvisor: 'Auf TripAdvisor verÃ¶ffentlichen',
                        submitExpedia: 'Auf Expedia verÃ¶ffentlichen',
                        cleanRooms: 'Saubere Zimmer',
                        friendlyStaff: 'Freundliches Personal',
                        greatLocation: 'Tolle Lage',
                        comfortable: 'Komfortabel',
                        breakfast: 'FrÃ¼hstÃ¼ck',
                        value: 'Gutes Preis-Leistungs-VerhÃ¤ltnis',
                        perfectLength: 'Perfekte LÃ¤nge!',
                        addMoreDetail: 'Mehr Details hinzufÃ¼gen',
                        greatDetail: 'GroÃŸartige Details!',
                        tooLong: 'KÃ¼rzer fassen',
                        validReview: 'Bewertung bereit zum Einreichen!',
                        invalidReview: 'Bitte beheben Sie die Probleme',
                        profanityDetected: 'Bitte entfernen Sie unangemessene Sprache',
                        tooShort: 'Bewertung ist zu kurz (mindestens 50 Zeichen)',
                        missingHotelName: 'ErwÃ¤gen Sie, den Hotelnamen zu erwÃ¤hnen',
                        shareReview: 'Bewertung Teilen',
                        qrCode: 'QR-Code',
                        qrInstructions: 'Scannen zum Teilen',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'E-Mail',
                        copyLink: 'Link Kopieren',
                        shareCount: 'Geteilt:',
                        viewCount: 'Aufrufe:',
                        linkCopied: 'âœ“ Link kopiert!',
                        shareSuccess: 'Erfolgreich geteilt!'
                    },
                    it: {
                        title: 'ğŸ¨ Generatore di Recensioni',
                        subtitle: 'Crea recensioni autentiche in secondi',
                        hotelName: 'Nome Hotel',
                        hotelPlaceholder: 'es., Hotel Grand Plaza',
                        aspects: 'Cosa ti Ã¨ piaciuto',
                        comments: 'Commenti Aggiuntivi (Opzionale)',
                        commentsPlaceholder: 'Dettagli specifici...',
                        generate: 'Genera Recensione',
                        yourReview: 'La Tua Recensione',
                        submitBooking: 'Pubblica su Booking.com',
                        submitGoogle: 'Pubblica su Google',
                        submitTripadvisor: 'Pubblica su TripAdvisor',
                        submitExpedia: 'Pubblica su Expedia',
                        cleanRooms: 'Camere Pulite',
                        friendlyStaff: 'Personale Cordiale',
                        greatLocation: 'Ottima Posizione',
                        comfortable: 'Confortevole',
                        breakfast: 'Colazione',
                        value: 'Ottimo Rapporto QualitÃ -Prezzo',
                        perfectLength: 'Lunghezza perfetta!',
                        addMoreDetail: 'Aggiungi piÃ¹ dettagli',
                        greatDetail: 'Ottimi dettagli!',
                        tooLong: 'Considera di accorciare',
                        validReview: 'Recensione pronta per l\'invio!',
                        invalidReview: 'Per favore risolvi i problemi',
                        profanityDetected: 'Per favore rimuovi il linguaggio inappropriato',
                        tooShort: 'La recensione Ã¨ troppo corta (minimo 50 caratteri)',
                        missingHotelName: 'Considera di menzionare il nome dell\'hotel',
                        shareReview: 'Condividi la Tua Recensione',
                        qrCode: 'Codice QR',
                        qrInstructions: 'Scansiona per condividere',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'Email',
                        copyLink: 'Copia Link',
                        shareCount: 'Condivisioni:',
                        viewCount: 'Visualizzazioni:',
                        linkCopied: 'âœ“ Link copiato!',
                        shareSuccess: 'Condivisione riuscita!'
                    },
                    zh: {
                        title: 'ğŸ¨ é…’åº—è¯„ä»·ç”Ÿæˆå™¨',
                        subtitle: 'å‡ ç§’é’Ÿå†…åˆ›å»ºçœŸå®è¯„ä»·',
                        hotelName: 'é…’åº—åç§°',
                        hotelPlaceholder: 'ä¾‹å¦‚ï¼šæ ¼å…°å¾·å¹¿åœºé…’åº—',
                        aspects: 'æ‚¨å–œæ¬¢çš„æ–¹é¢',
                        comments: 'å…¶ä»–è¯„è®ºï¼ˆå¯é€‰ï¼‰',
                        commentsPlaceholder: 'å…·ä½“ç»†èŠ‚...',
                        generate: 'ç”Ÿæˆè¯„ä»·',
                        yourReview: 'æ‚¨çš„è¯„ä»·',
                        submitBooking: 'å‘å¸ƒåˆ° Booking.com',
                        submitGoogle: 'å‘å¸ƒåˆ° Google',
                        submitTripadvisor: 'å‘å¸ƒåˆ° TripAdvisor',
                        submitExpedia: 'å‘å¸ƒåˆ° Expedia',
                        cleanRooms: 'å¹²å‡€çš„æˆ¿é—´',
                        friendlyStaff: 'å‹å¥½çš„å‘˜å·¥',
                        greatLocation: 'ç»ä½³ä½ç½®',
                        comfortable: 'èˆ’é€‚',
                        breakfast: 'æ—©é¤',
                        value: 'ç‰©è¶…æ‰€å€¼',
                        perfectLength: 'é•¿åº¦å®Œç¾ï¼',
                        addMoreDetail: 'æ·»åŠ æ›´å¤šç»†èŠ‚',
                        greatDetail: 'å¾ˆå¥½çš„ç»†èŠ‚ï¼',
                        tooLong: 'è€ƒè™‘ç¼©çŸ­ä¸€ä¸‹',
                        validReview: 'è¯„ä»·å·²å‡†å¤‡å¥½æäº¤ï¼',
                        invalidReview: 'è¯·ä¿®å¤é—®é¢˜',
                        profanityDetected: 'è¯·åˆ é™¤ä¸å½“ç”¨è¯­',
                        tooShort: 'è¯„ä»·å¤ªçŸ­ï¼ˆè‡³å°‘50ä¸ªå­—ç¬¦ï¼‰',
                        missingHotelName: 'è€ƒè™‘æåŠé…’åº—åç§°',
                        shareReview: 'åˆ†äº«æ‚¨çš„è¯„ä»·',
                        qrCode: 'äºŒç»´ç ',
                        qrInstructions: 'æ‰«ç åˆ†äº«',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'é‚®ä»¶',
                        copyLink: 'å¤åˆ¶é“¾æ¥',
                        shareCount: 'åˆ†äº«æ¬¡æ•°ï¼š',
                        viewCount: 'æµè§ˆæ¬¡æ•°ï¼š',
                        linkCopied: 'âœ“ é“¾æ¥å·²å¤åˆ¶ï¼',
                        shareSuccess: 'åˆ†äº«æˆåŠŸï¼'
                    },
                    el: {
                        title: 'ğŸ¨ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÏŒÏ‚ ÎšÏÎ¹Ï„Î¹ÎºÏÎ½ ÎÎµÎ½Î¿Î´Î¿Ï‡ÎµÎ¯Ï‰Î½',
                        subtitle: 'Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ­Ï‚ ÎºÏÎ¹Ï„Î¹ÎºÎ­Ï‚ ÏƒÎµ Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±',
                        hotelName: 'ÎŒÎ½Î¿Î¼Î± ÎÎµÎ½Î¿Î´Î¿Ï‡ÎµÎ¯Î¿Ï…',
                        hotelPlaceholder: 'Ï€.Ï‡., Grand Plaza Hotel',
                        aspects: 'Î¤Î¹ ÏƒÎ±Ï‚ Î¬ÏÎµÏƒÎµ',
                        comments: 'Î•Ï€Î¹Ï€Î»Î­Î¿Î½ Î£Ï‡ÏŒÎ»Î¹Î± (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)',
                        commentsPlaceholder: 'Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚...',
                        generate: 'Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎšÏÎ¹Ï„Î¹ÎºÎ®Ï‚',
                        yourReview: 'Î— ÎšÏÎ¹Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚',
                        submitBooking: 'Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Booking.com',
                        submitGoogle: 'Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Google',
                        submitTripadvisor: 'Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ TripAdvisor',
                        submitExpedia: 'Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Expedia',
                        cleanRooms: 'ÎšÎ±Î¸Î±ÏÎ¬ Î”Ï‰Î¼Î¬Ï„Î¹Î±',
                        friendlyStaff: 'Î¦Î¹Î»Î¹ÎºÏŒ Î ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒ',
                        greatLocation: 'Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ® Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±',
                        comfortable: 'Î†Î½ÎµÏ„Î¿',
                        breakfast: 'Î ÏÏ‰Î¹Î½ÏŒ',
                        value: 'ÎšÎ±Î»Î® Î¤Î¹Î¼Î®',
                        perfectLength: 'Î¤Î­Î»ÎµÎ¹Î¿ Î¼Î®ÎºÎ¿Ï‚!',
                        addMoreDetail: 'Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Î»Î¯Î³ÎµÏ‚ Î±ÎºÏŒÎ¼Î· Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚',
                        greatDetail: 'Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚!',
                        tooLong: 'Î£ÎºÎµÏ†Ï„ÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÏ„Îµ Ï€Î¹Î¿ ÏƒÏÎ½Ï„Î¿Î¼Î¿',
                        validReview: 'Î— ÎºÏÎ¹Ï„Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Î­Ï„Î¿Î¹Î¼Î· Î³Î¹Î± Ï…Ï€Î¿Î²Î¿Î»Î®!',
                        invalidReview: 'Î Î±ÏÎ±ÎºÎ±Î»Ï Î´Î¹Î¿ÏÎ¸ÏÏƒÏ„Îµ Ï„Î± Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î±',
                        profanityDetected: 'Î Î±ÏÎ±ÎºÎ±Î»Ï Î±Ï†Î±Î¹ÏÎ­ÏƒÏ„Îµ Î±ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· Î³Î»ÏÏƒÏƒÎ±',
                        tooShort: 'Î— ÎºÏÎ¹Ï„Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï ÏƒÏÎ½Ï„Î¿Î¼Î· (ÎµÎ»Î¬Ï‡Î¹ÏƒÏ„Î¿ 50 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚)',
                        missingHotelName: 'Î£ÎºÎµÏ†Ï„ÎµÎ¯Ï„Îµ Î½Î± Î±Î½Î±Ï†Î­ÏÎµÏ„Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… Î¾ÎµÎ½Î¿Î´Î¿Ï‡ÎµÎ¯Î¿Ï…',
                        shareReview: 'ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î·Î½ ÎšÏÎ¹Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚',
                        qrCode: 'ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ QR',
                        qrInstructions: 'Î£Î±ÏÏÏƒÏ„Îµ Î³Î¹Î± Î½Î± Î¼Î¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ',
                        shareWhatsApp: 'WhatsApp',
                        shareFacebook: 'Facebook',
                        shareTwitter: 'Twitter',
                        shareEmail: 'Email',
                        copyLink: 'Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® Î£Ï…Î½Î´Î­ÏƒÎ¼Î¿Ï…',
                        shareCount: 'ÎšÎ¿Î¹Î½Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚:',
                        viewCount: 'Î ÏÎ¿Î²Î¿Î»Î­Ï‚:',
                        linkCopied: 'âœ“ Î£ÏÎ½Î´ÎµÏƒÎ¼Î¿Ï‚ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ!',
                        shareSuccess: 'Î•Ï€Î¹Ï„Ï…Ï‡Î·Î¼Î­Î½Î· ÎºÎ¿Î¹Î½Î¿Ï€Î¿Î¯Î·ÏƒÎ·!'
                    }
                };
                
                // Profanity filter (basic)
                this.profanityList = ['damn', 'hell', 'crap'];
                
                this.init();
            }

            init() {
                this.detectLanguage();
                this.setupEventListeners();
                this.setupProgressiveDisclosure();
                this.setupDraftManagement();
                this.setupExitIntent();
                this.restoreDraft();
                this.addMicroAnimations();
                this.handleSharedLink();
            }

            /**
             * Detect browser language and set default
             */
            detectLanguage() {
                const browserLang = navigator.language.split('-')[0];
                const supportedLangs = Object.keys(this.translations);
                
                if (supportedLangs.includes(browserLang)) {
                    this.currentLanguage = browserLang;
                } else {
                    this.currentLanguage = 'en';
                }
                
                // Check for saved preference
                const savedLang = localStorage.getItem('preferred_language');
                if (savedLang && supportedLangs.includes(savedLang)) {
                    this.currentLanguage = savedLang;
                }
                
                this.translateUI(this.currentLanguage);
                return this.currentLanguage;
            }

            /**
             * Translate UI elements
             */
            translateUI(lang) {
                if (!this.translations[lang]) {
                    lang = 'en'; // Fallback
                }
                
                const t = this.translations[lang];
                
                // Update all elements with data-i18n attribute
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (t[key]) {
                        el.textContent = t[key];
                    }
                });
                
                // Update placeholders
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.getAttribute('data-i18n-placeholder');
                    if (t[key]) {
                        el.placeholder = t[key];
                    }
                });
                
                // Update language buttons
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.lang === lang);
                });
                
                this.currentLanguage = lang;
                localStorage.setItem('preferred_language', lang);
                
                return { language: lang };
            }

            /**
             * Setup all event listeners
             */
            setupEventListeners() {
                // Language selector
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.translateUI(e.target.dataset.lang);
                    });
                });
                
                // Hotel name input
                const hotelInput = document.getElementById('hotel-name');
                hotelInput.addEventListener('input', () => {
                    this.handleHotelNameInput();
                });
                
                // Aspect cards
                document.querySelectorAll('.aspect-card').forEach(card => {
                    card.addEventListener('click', () => this.toggleAspect(card));
                    card.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            this.toggleAspect(card);
                        }
                    });
                });
                
                // Comments textarea with debounced save
                const comments = document.getElementById('comments');
                const debouncedSave = this.debounce(() => {
                    this.saveDraft();
                }, 1000);
                
                comments.addEventListener('input', () => {
                    this.updateLengthIndicator();
                    debouncedSave();
                });
                
                // Staff recognition input with debounced save
                const staffInput = document.getElementById('staff-recognition');
                if (staffInput) {
                    staffInput.addEventListener('input', () => {
                        debouncedSave();
                    });
                }
                
                // Generate button
                document.getElementById('generate-btn').addEventListener('click', () => {
                    this.generateReview();
                });
                
                // Platform submit buttons
                document.querySelectorAll('.platform-submit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.submitToPlatform(e.target.dataset.platform);
                    });
                });

                // Sharing buttons
                this.setupSharingEventListeners();
            }

            /**
             * Setup progressive form disclosure
             */
            setupProgressiveDisclosure() {
                // Initially only show hotel name section
                document.getElementById('aspects-section').classList.add('hidden');
                document.getElementById('comments-section').classList.add('hidden');
            }

            /**
             * Handle hotel name input
             */
            handleHotelNameInput() {
                const hotelName = document.getElementById('hotel-name').value.trim();
                
                if (hotelName.length > 0) {
                    // Reveal aspects section
                    this.revealSection('aspects');
                    
                    // Check if aspects are selected
                    if (this.selectedAspects.size > 0) {
                        this.revealSection('comments');
                    }
                }
                
                this.saveDraft();
            }

            /**
             * Reveal a form section with animation
             */
            revealSection(sectionName) {
                const section = document.getElementById(`${sectionName}-section`);
                if (section && section.classList.contains('hidden')) {
                    section.classList.remove('hidden');
                    section.classList.add('revealing');
                    
                    // Announce to screen readers
                    this.announce(`${sectionName} section is now available`);
                    
                    setTimeout(() => {
                        section.classList.remove('revealing');
                    }, 400);
                }
            }

            /**
             * Toggle aspect selection
             */
            toggleAspect(card) {
                const aspect = card.dataset.aspect;
                
                if (this.selectedAspects.has(aspect)) {
                    this.selectedAspects.delete(aspect);
                    card.classList.remove('selected');
                    card.setAttribute('aria-pressed', 'false');
                } else {
                    this.selectedAspects.add(aspect);
                    card.classList.add('selected');
                    card.setAttribute('aria-pressed', 'true');
                }
                
                // Reveal comments section if aspects are selected
                if (this.selectedAspects.size > 0 && document.getElementById('hotel-name').value) {
                    this.revealSection('comments');
                }
                
                this.saveDraft();
            }

            /**
             * Update review length indicator
             */
            updateLengthIndicator() {
                const comments = document.getElementById('comments').value;
                const totalLength = comments.length + (this.selectedAspects.size * 50); // Estimate
                
                const indicator = document.getElementById('length-indicator');
                const text = document.getElementById('length-text');
                const fill = document.getElementById('length-fill');
                
                let status, message, fillPercent, fillColor;
                
                if (totalLength < 50) {
                    status = 'warning';
                    message = this.translations[this.currentLanguage].addMoreDetail || 'Add more detail';
                    fillPercent = (totalLength / 50) * 30;
                    fillColor = 'var(--warning)';
                } else if (totalLength >= 50 && totalLength <= 200) {
                    status = 'perfect';
                    message = this.translations[this.currentLanguage].perfectLength || 'Perfect length!';
                    fillPercent = 30 + ((totalLength - 50) / 150) * 40;
                    fillColor = 'var(--success)';
                } else if (totalLength > 200 && totalLength <= 400) {
                    status = 'good';
                    message = this.translations[this.currentLanguage].greatDetail || 'Great detail!';
                    fillPercent = 70 + ((totalLength - 200) / 200) * 20;
                    fillColor = 'var(--primary)';
                } else {
                    status = 'warning';
                    message = this.translations[this.currentLanguage].tooLong || 'Consider shortening';
                    fillPercent = 90 + Math.min((totalLength - 400) / 100, 1) * 10;
                    fillColor = 'var(--warning)';
                }
                
                indicator.className = `length-indicator ${status}`;
                text.textContent = `${message} (${totalLength} chars)`;
                fill.style.width = `${fillPercent}%`;
                fill.style.background = fillColor;
                
                return { status, message };
            }

            /**
             * Validate review content
             */
            validateReview(review, hotelName) {
                const errors = [];
                const warnings = [];
                
                // Check for profanity
                const lowerReview = review.toLowerCase();
                for (const word of this.profanityList) {
                    if (lowerReview.includes(word)) {
                        errors.push(this.translations[this.currentLanguage].profanityDetected || 'inappropriate language');
                        break;
                    }
                }
                
                // Check minimum length
                if (review.length < 50) {
                    errors.push(this.translations[this.currentLanguage].tooShort || 'too short');
                }
                
                // Check if hotel name is mentioned
                if (hotelName && !review.toLowerCase().includes(hotelName.toLowerCase())) {
                    warnings.push(this.translations[this.currentLanguage].missingHotelName || 'hotel name not mentioned');
                }
                
                const valid = errors.length === 0;
                
                // Show validation indicator
                this.showValidation(valid, errors, warnings);
                
                return { valid, errors, warnings };
            }

            /**
             * Show validation indicator
             */
            showValidation(valid, errors = [], warnings = []) {
                const indicator = document.getElementById('validation-indicator');
                const text = document.getElementById('validation-text');
                
                indicator.classList.remove('hidden');
                
                if (valid) {
                    indicator.className = 'validation-indicator valid';
                    text.textContent = this.translations[this.currentLanguage].validReview || 'Review ready!';
                } else {
                    indicator.className = 'validation-indicator invalid';
                    text.textContent = errors[0] || this.translations[this.currentLanguage].invalidReview || 'Please fix issues';
                }
            }

            /**
             * Generate review
             */
            generateReview() {
                const hotelName = document.getElementById('hotel-name').value.trim();
                
                if (!hotelName) {
                    this.showToast('Please enter hotel name', 'error');
                    return;
                }
                
                if (this.selectedAspects.size === 0) {
                    this.showToast('Please select at least one aspect', 'error');
                    return;
                }
                
                const btn = document.getElementById('generate-btn');
                const output = document.getElementById('output-section');
                
                // Show loading with skeleton
                btn.innerHTML = '<span>Generating...</span><span class="loading">â³</span>';
                btn.disabled = true;
                
                this.showSkeletonLoader();
                
                setTimeout(() => {
                    // Generate review (always in English)
                    const review = this.createReview(hotelName);
                    
                    // Validate review
                    const validation = this.validateReview(review, hotelName);
                    
                    // Show output
                    document.getElementById('review-output').textContent = review;
                    output.classList.remove('hidden');
                    
                    // Show sharing section and generate QR code
                    this.showSharingSection(review, hotelName);
                    
                    // Reset button
                    btn.innerHTML = `<span>${this.translations[this.currentLanguage].generate}</span><span>âœ¨</span>`;
                    btn.disabled = false;
                    
                    // Hide skeleton
                    this.hideSkeletonLoader();
                    
                    // Scroll to output
                    output.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    
                    // Announce to screen readers
                    this.announce('Review generated successfully');
                    
                    // Clear draft after successful generation
                    localStorage.removeItem('hotelReviewDraft');
                }, 800);
            }

            /**
             * Create review text (always in English)
             */
            createReview(hotelName) {
                const aspects = Array.from(this.selectedAspects);
                const comments = document.getElementById('comments').value.trim();
                const staffName = document.getElementById('staff-recognition').value.trim();
                
                const aspectSentences = {
                    'Clean Rooms': 'The rooms were spotlessly clean and well-maintained.',
                    'Friendly Staff': 'The staff were incredibly friendly and helpful.',
                    'Great Location': 'The location was perfect for exploring the area.',
                    'Comfortable Beds': 'The beds were extremely comfortable.',
                    'Delicious Breakfast': 'The breakfast was delicious with great variety.',
                    'Excellent Value': 'Excellent value for money.'
                };
                
                // Add staff recognition sentence if provided
                let staffRecognition = '';
                if (staffName) {
                    const staffTemplates = [
                        `Special thanks to ${staffName} for their exceptional service! `,
                        `I must mention ${staffName} who went above and beyond to make our stay memorable. `,
                        `${staffName} provided outstanding service throughout our stay. `,
                        `A special shoutout to ${staffName} for their incredible hospitality. `
                    ];
                    staffRecognition = staffTemplates[Math.floor(Math.random() * staffTemplates.length)];
                }
                
                const templates = [
                    `I had a wonderful stay at ${hotelName}! ${aspects.map(a => aspectSentences[a]).join(' ')} ${staffRecognition}${comments ? comments + ' ' : ''}Highly recommended!`,
                    `${hotelName} exceeded my expectations. ${aspects.map(a => aspectSentences[a]).join(' ')} ${staffRecognition}${comments ? comments + ' ' : ''}Would definitely stay again!`,
                    `Great experience at ${hotelName}. ${aspects.map(a => aspectSentences[a]).join(' ')} ${staffRecognition}${comments ? comments + ' ' : ''}Perfect for anyone visiting the area.`
                ];
                
                return templates[Math.floor(Math.random() * templates.length)];
            }

            /**
             * Submit review to platform
             */
            submitToPlatform(platform, review, hotelName) {
                review = review || document.getElementById('review-output').textContent;
                hotelName = hotelName || document.getElementById('hotel-name').value;
                
                // Get cached URL or create new
                let url = this.platformUrls.get(platform);
                if (!url) {
                    url = this.getPlatformUrl(platform, hotelName);
                    this.platformUrls.set(platform, url);
                }
                
                // Copy to clipboard first
                this.copyToClipboard(review);
                
                // Open platform in new tab
                const newWindow = window.open(url, '_blank');
                
                if (newWindow) {
                    this.showToast(`Opening ${platform}... Review copied!`, 'success');
                    
                    // Track analytics
                    if (this.analytics) {
                        this.analytics.track('platform_submit', {
                            platform,
                            reviewLength: review.length
                        });
                    }
                } else {
                    // Popup blocked, provide fallback
                    this.showToast('Review copied! Please paste on the platform.', 'info');
                    return { error: true, fallback: 'copy_to_clipboard' };
                }
            }

            /**
             * Get platform submission URL
             */
            getPlatformUrl(platform, hotelName) {
                const encodedHotel = encodeURIComponent(hotelName);
                
                const urls = {
                    booking: `https://www.booking.com/reviewlist.html?q=${encodedHotel}`,
                    google: `https://www.google.com/search?q=${encodedHotel}+review`,
                    tripadvisor: `https://www.tripadvisor.com/Search?q=${encodedHotel}`,
                    expedia: `https://www.expedia.com/Hotel-Search?destination=${encodedHotel}`
                };
                
                return urls[platform] || urls.google;
            }

            /**
             * Copy text to clipboard
             */
            copyToClipboard(text) {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(text);
                } else {
                    // Fallback
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                }
            }

            /**
             * Setup draft management
             */
            setupDraftManagement() {
                // Auto-save every 5 seconds (debounced)
                this.draftTimer = setInterval(() => {
                    this.saveDraft();
                }, 5000);
                
                // Save on visibility change
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        this.saveDraft();
                    }
                });
            }

            /**
             * Save draft to localStorage
             */
            saveDraft() {
                try {
                    const draft = {
                        hotelName: document.getElementById('hotel-name').value,
                        aspects: Array.from(this.selectedAspects),
                        comments: document.getElementById('comments').value,
                        staffRecognition: document.getElementById('staff-recognition').value,
                        timestamp: Date.now()
                    };
                    
                    localStorage.setItem('hotelReviewDraft', JSON.stringify(draft));
                } catch (e) {
                    // Handle quota exceeded or other errors
                    console.warn('Could not save draft:', e);
                }
            }

            /**
             * Restore draft from localStorage
             */
            restoreDraft() {
                try {
                    const saved = localStorage.getItem('hotelReviewDraft');
                    if (saved) {
                        const draft = JSON.parse(saved);
                        
                        // Only restore if less than 24 hours old
                        if (Date.now() - draft.timestamp < 86400000) {
                            document.getElementById('hotel-name').value = draft.hotelName || '';
                            document.getElementById('comments').value = draft.comments || '';
                            document.getElementById('staff-recognition').value = draft.staffRecognition || '';
                            
                            draft.aspects.forEach(aspect => {
                                const card = document.querySelector(`[data-aspect="${aspect}"]`);
                                if (card) {
                                    this.selectedAspects.add(aspect);
                                    card.classList.add('selected');
                                    card.setAttribute('aria-pressed', 'true');
                                }
                            });
                            
                            // Trigger progressive disclosure
                            if (draft.hotelName) {
                                this.handleHotelNameInput();
                            }
                            
                            if (draft.hotelName || draft.aspects.length > 0) {
                                this.showToast('Draft restored', 'info');
                            }
                        }
                    }
                } catch (e) {
                    console.warn('Could not restore draft:', e);
                }
            }

            /**
             * Setup exit intent handling
             */
            setupExitIntent() {
                window.addEventListener('beforeunload', (e) => {
                    return this.handleBeforeUnload(e);
                });
            }

            /**
             * Handle before unload event
             */
            handleBeforeUnload(e) {
                const hotelName = document.getElementById('hotel-name').value;
                const comments = document.getElementById('comments').value;
                const hasChanges = hotelName || this.selectedAspects.size > 0 || comments;
                const reviewGenerated = document.getElementById('review-output').textContent;
                
                if (hasChanges && !reviewGenerated) {
                    // Save draft before leaving
                    this.saveDraft();
                    
                    // Standard way to trigger browser warning
                    e.preventDefault();
                    e.returnValue = '';
                    return '';
                }
            }

            /**
             * Add micro-animations to interactive elements
             */
            addMicroAnimations() {
                // Add press animation to all buttons
                document.querySelectorAll('.btn, .aspect-card, .platform-submit-btn').forEach(el => {
                    el.addEventListener('mousedown', () => {
                        el.style.animation = 'buttonPress 0.2s ease-out';
                    });
                    
                    el.addEventListener('animationend', () => {
                        el.style.animation = '';
                    });
                });
            }

            /**
             * Show skeleton loader
             */
            showSkeletonLoader() {
                const output = document.getElementById('output-section');
                output.classList.remove('hidden');
                
                const skeleton = document.createElement('div');
                skeleton.className = 'skeleton-loader';
                skeleton.innerHTML = `
                    <div class="skeleton skeleton-text" style="width: 80%;"></div>
                    <div class="skeleton skeleton-text" style="width: 90%;"></div>
                    <div class="skeleton skeleton-text" style="width: 75%;"></div>
                `;
                
                const reviewOutput = document.getElementById('review-output');
                reviewOutput.innerHTML = '';
                reviewOutput.appendChild(skeleton);
            }

            /**
             * Hide skeleton loader
             */
            hideSkeletonLoader() {
                const skeleton = document.querySelector('.skeleton-loader');
                if (skeleton) {
                    skeleton.remove();
                }
            }

            /**
             * Show toast notification
             */
            showToast(message, type = 'info') {
                const existing = document.querySelector('.toast');
                if (existing) {
                    existing.remove();
                }
                
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideInUp 0.3s ease-out reverse';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }

            /**
             * Announce to screen readers
             */
            announce(message) {
                const announcer = document.getElementById('sr-announcements');
                announcer.textContent = message;
            }

            /**
             * Debounce utility
             */
            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            /**
             * Get progress percentage
             */
            getProgressPercentage() {
                let steps = 0;
                if (document.getElementById('hotel-name').value) steps++;
                if (this.selectedAspects.size > 0) steps++;
                if (document.getElementById('comments').value) steps++;
                if (document.getElementById('review-output').textContent) steps++;
                
                return (steps / 4) * 100;
            }

            /**
             * Generate unique tracking ID for shares
             */
            generateTrackingId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            /**
             * Setup sharing event listeners
             */
            setupSharingEventListeners() {
                document.getElementById('share-whatsapp')?.addEventListener('click', () => {
                    this.shareViaWhatsApp();
                });

                document.getElementById('share-facebook')?.addEventListener('click', () => {
                    this.shareViaFacebook();
                });

                document.getElementById('share-twitter')?.addEventListener('click', () => {
                    this.shareViaTwitter();
                });

                document.getElementById('share-email')?.addEventListener('click', () => {
                    this.shareViaEmail();
                });

                document.getElementById('share-copy')?.addEventListener('click', () => {
                    this.copyShareableLink();
                });
            }

            /**
             * Show sharing section with QR code generation
             */
            showSharingSection(review, hotelName) {
                const sharingSection = document.getElementById('sharing-section');
                if (sharingSection) {
                    sharingSection.classList.remove('hidden');
                    
                    // Generate QR code
                    this.generateQRCode(review, hotelName);
                    
                    // Load share statistics
                    this.loadShareStatistics();
                }
            }

            /**
             * Generate QR code for sharing
             */
            generateQRCode(review, hotelName) {
                const canvas = document.getElementById('qr-canvas');
                if (canvas && window.QRCode) {
                    const shareableLink = this.generateShareableLink(review, hotelName);
                    
                    QRCode.toCanvas(canvas, shareableLink, {
                        width: 120,
                        margin: 2,
                        color: {
                            dark: '#000000',
                            light: '#FFFFFF'
                        }
                    }, (error) => {
                        if (error) {
                            console.warn('QR Code generation failed:', error);
                            canvas.style.display = 'none';
                        }
                    });
                }
            }

            /**
             * Generate shareable link with tracking parameters
             */
            generateShareableLink(review, hotelName) {
                const baseUrl = window.location.origin + window.location.pathname;
                const params = new URLSearchParams({
                    hotel: hotelName,
                    review: review.substring(0, 100) + '...',
                    tid: this.shareData.trackingId,
                    source: 'qr'
                });
                
                return `${baseUrl}?${params.toString()}`;
            }

            /**
             * Share via WhatsApp
             */
            shareViaWhatsApp() {
                const review = document.getElementById('review-output').textContent;
                const hotelName = document.getElementById('hotel-name').value;
                const shareableLink = this.generateShareableLink(review, hotelName);
                
                const message = `Check out my review of ${hotelName}!\n\n"${review.substring(0, 200)}..."\n\n${shareableLink}`;
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                
                this.openShare(whatsappUrl, 'whatsapp');
            }

            /**
             * Share via Facebook
             */
            shareViaFacebook() {
                const review = document.getElementById('review-output').textContent;
                const hotelName = document.getElementById('hotel-name').value;
                const shareableLink = this.generateShareableLink(review, hotelName);
                
                const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareableLink)}&quote=${encodeURIComponent(`My review of ${hotelName}: ${review.substring(0, 200)}...`)}`;
                
                this.openShare(facebookUrl, 'facebook');
            }

            /**
             * Share via Twitter
             */
            shareViaTwitter() {
                const review = document.getElementById('review-output').textContent;
                const hotelName = document.getElementById('hotel-name').value;
                const shareableLink = this.generateShareableLink(review, hotelName);
                
                const tweet = `My review of ${hotelName}: "${review.substring(0, 150)}..." ${shareableLink} #HotelReview`;
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweet)}`;
                
                this.openShare(twitterUrl, 'twitter');
            }

            /**
             * Share via Email
             */
            shareViaEmail() {
                const review = document.getElementById('review-output').textContent;
                const hotelName = document.getElementById('hotel-name').value;
                const shareableLink = this.generateShareableLink(review, hotelName);
                
                const subject = `My Review of ${hotelName}`;
                const body = `Hi,\n\nI wanted to share my recent review of ${hotelName}:\n\n"${review}"\n\nYou can read more reviews like this at: ${shareableLink}\n\nBest regards!`;
                
                const emailUrl = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                this.openShare(emailUrl, 'email');
            }

            /**
             * Copy shareable link to clipboard
             */
            copyShareableLink() {
                const review = document.getElementById('review-output').textContent;
                const hotelName = document.getElementById('hotel-name').value;
                const shareableLink = this.generateShareableLink(review, hotelName);
                
                this.copyToClipboard(shareableLink);
                
                // Show success animation
                const successElement = document.getElementById('copy-success');
                if (successElement) {
                    successElement.classList.add('show');
                    setTimeout(() => {
                        successElement.classList.remove('show');
                    }, 2000);
                }
                
                this.trackShare('copy');
                this.showToast(this.translations[this.currentLanguage].linkCopied || 'âœ“ Link copied!', 'success');
            }

            /**
             * Open share window and track
             */
            openShare(url, platform) {
                const newWindow = window.open(url, '_blank', 'width=600,height=400');
                
                if (newWindow) {
                    this.trackShare(platform);
                    this.showToast(this.translations[this.currentLanguage].shareSuccess || 'Share successful!', 'success');
                } else {
                    // Fallback for blocked popups
                    window.location.href = url;
                }
            }

            /**
             * Track share event
             */
            trackShare(platform) {
                this.shareData.shareCount++;
                
                // Update UI
                document.getElementById('share-count').textContent = this.shareData.shareCount;
                
                // Save to localStorage
                this.saveShareStatistics();
                
                // Track with analytics
                if (this.analytics) {
                    this.analytics.track('share_review', {
                        platform,
                        trackingId: this.shareData.trackingId,
                        shareCount: this.shareData.shareCount
                    });
                }
            }

            /**
             * Load share statistics from localStorage
             */
            loadShareStatistics() {
                try {
                    const saved = localStorage.getItem('shareStatistics');
                    if (saved) {
                        const stats = JSON.parse(saved);
                        this.shareData.shareCount = stats.shareCount || 0;
                        this.shareData.viewCount = stats.viewCount || 0;
                        
                        // Update UI
                        document.getElementById('share-count').textContent = this.shareData.shareCount;
                        document.getElementById('view-count').textContent = this.shareData.viewCount;
                    }
                    
                    // Increment view count
                    this.shareData.viewCount++;
                    document.getElementById('view-count').textContent = this.shareData.viewCount;
                    this.saveShareStatistics();
                    
                } catch (e) {
                    console.warn('Could not load share statistics:', e);
                }
            }

            /**
             * Save share statistics to localStorage
             */
            saveShareStatistics() {
                try {
                    const stats = {
                        shareCount: this.shareData.shareCount,
                        viewCount: this.shareData.viewCount,
                        trackingId: this.shareData.trackingId,
                        lastUpdate: Date.now()
                    };
                    localStorage.setItem('shareStatistics', JSON.stringify(stats));
                } catch (e) {
                    console.warn('Could not save share statistics:', e);
                }
            }

            /**
             * Handle shared link parameters
             */
            handleSharedLink() {
                const urlParams = new URLSearchParams(window.location.search);
                const hotelParam = urlParams.get('hotel');
                const reviewParam = urlParams.get('review');
                const trackingId = urlParams.get('tid');
                const source = urlParams.get('source');

                if (hotelParam && reviewParam) {
                    // Pre-fill form with shared data
                    document.getElementById('hotel-name').value = hotelParam;
                    
                    // Show preview of shared review
                    this.showToast(`Viewing shared review of ${hotelParam}`, 'info');
                    
                    // Track link view
                    if (this.analytics && trackingId) {
                        this.analytics.track('shared_link_view', {
                            trackingId,
                            source,
                            hotel: hotelParam
                        });
                    }
                    
                    // Clean URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            }

            /**
             * Load translations (for lazy loading)
             */
            async loadTranslations(lang) {
                // In production, this would fetch from a CDN
                return this.translations[lang];
            }

            /**
             * Set language
             */
            async setLanguage(lang) {
                await this.loadTranslations(lang);
                this.translateUI(lang);
            }

            /**
             * Initialize analytics
             */
            analytics = {
                track: (event, data) => {
                    // Privacy-friendly local analytics
                    const events = JSON.parse(localStorage.getItem('analytics_events') || '[]');
                    events.push({ event, data, timestamp: Date.now() });
                    
                    // Keep only last 100 events
                    if (events.length > 100) {
                        events.splice(0, events.length - 100);
                    }
                    
                    localStorage.setItem('analytics_events', JSON.stringify(events));
                }
            };
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            window.hotelReviewGenerator = new HotelReviewGeneratorV3();
        });

        // Register service worker for offline support
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(console.log);
        }
    </script>
    <!-- Analytics Dashboard Link -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
        <a href="analytics-dashboard.html" 
           style="display: inline-flex; align-items: center; gap: 0.5rem; 
                  background: #1e40af; color: white; padding: 0.75rem 1rem; 
                  border-radius: 999px; text-decoration: none; 
                  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                  font-weight: 600; font-size: 0.875rem;
                  transition: all 150ms ease;">
            ğŸ“Š View Analytics
        </a>
    </div>

</body>
</html>