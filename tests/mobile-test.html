<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Device Test Suite</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 { color: #1e40af; }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: #f3f4f6;
            border-radius: 8px;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status { 
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .pass { background: #d1fae5; color: #065f46; }
        .fail { background: #fee2e2; color: #991b1b; }
        .pending { background: #fef3c7; color: #92400e; }
        button {
            background: #1e40af;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
        }
        button:hover { background: #1e3a8a; }
        .device-info {
            background: #eff6ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .qr-code {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border: 2px dashed #e5e7eb;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📱 Mobile Device Test Suite</h1>
        <p>Test the Hotel Review Generator on your mobile device</p>
        
        <div class="qr-code">
            <h3>Scan QR Code on Mobile</h3>
            <p>URL: <strong id="test-url"></strong></p>
            <canvas id="qr-canvas"></canvas>
        </div>
        
        <div class="device-info">
            <h3>Device Information</h3>
            <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
            <p><strong>Screen Size:</strong> <span id="screen-size"></span></p>
            <p><strong>Viewport:</strong> <span id="viewport"></span></p>
            <p><strong>Touch Support:</strong> <span id="touch-support"></span></p>
            <p><strong>PWA Support:</strong> <span id="pwa-support"></span></p>
            <p><strong>Language:</strong> <span id="language"></span></p>
        </div>
        
        <div class="test-section">
            <h3>Mobile Feature Tests</h3>
            
            <div class="test-item">
                <span>Touch Events</span>
                <span class="status pending" id="touch-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Service Worker</span>
                <span class="status pending" id="sw-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Offline Mode</span>
                <span class="status pending" id="offline-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Install Prompt</span>
                <span class="status pending" id="install-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Clipboard API</span>
                <span class="status pending" id="clipboard-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Language Detection</span>
                <span class="status pending" id="lang-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>Responsive Layout</span>
                <span class="status pending" id="responsive-test">Pending</span>
            </div>
            
            <div class="test-item">
                <span>44px Touch Targets</span>
                <span class="status pending" id="touch-target-test">Pending</span>
            </div>
        </div>
        
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="testOfflineMode()">Test Offline Mode</button>
        <button onclick="testInstallPrompt()">Test Install Prompt</button>
        <button onclick="openApp()">Open Ultimate App</button>
        
        <div class="test-section">
            <h3>Test Results Summary</h3>
            <div id="summary"></div>
        </div>
    </div>

    <script>
        // Display device information
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('screen-size').textContent = `${screen.width}x${screen.height}`;
        document.getElementById('viewport').textContent = `${window.innerWidth}x${window.innerHeight}`;
        document.getElementById('touch-support').textContent = 'ontouchstart' in window ? 'Yes' : 'No';
        document.getElementById('pwa-support').textContent = 'serviceWorker' in navigator ? 'Yes' : 'No';
        document.getElementById('language').textContent = navigator.language;
        
        // Generate test URL
        const testUrl = window.location.origin + '/src/ultimate-hotel-review-generator.html';
        document.getElementById('test-url').textContent = testUrl;
        
        // Simple QR code placeholder (in production, use a QR library)
        const canvas = document.getElementById('qr-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 200;
        canvas.height = 200;
        ctx.fillStyle = '#1e40af';
        ctx.fillRect(0, 0, 200, 200);
        ctx.fillStyle = 'white';
        ctx.font = '14px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('QR Code', 100, 95);
        ctx.fillText('(Use QR generator)', 100, 115);
        
        // Test functions
        async function runAllTests() {
            // Touch Events Test
            const touchTest = document.getElementById('touch-test');
            if ('ontouchstart' in window) {
                touchTest.textContent = 'Pass';
                touchTest.className = 'status pass';
            } else {
                touchTest.textContent = 'Fail';
                touchTest.className = 'status fail';
            }
            
            // Service Worker Test
            const swTest = document.getElementById('sw-test');
            if ('serviceWorker' in navigator) {
                try {
                    const reg = await navigator.serviceWorker.getRegistration();
                    swTest.textContent = reg ? 'Pass' : 'Not Registered';
                    swTest.className = reg ? 'status pass' : 'status pending';
                } catch {
                    swTest.textContent = 'Error';
                    swTest.className = 'status fail';
                }
            } else {
                swTest.textContent = 'Not Supported';
                swTest.className = 'status fail';
            }
            
            // Offline Mode Test
            const offlineTest = document.getElementById('offline-test');
            if ('onLine' in navigator) {
                offlineTest.textContent = navigator.onLine ? 'Online' : 'Offline';
                offlineTest.className = 'status pass';
            } else {
                offlineTest.textContent = 'Unknown';
                offlineTest.className = 'status pending';
            }
            
            // Install Prompt Test
            const installTest = document.getElementById('install-test');
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                installTest.textContent = 'Available';
                installTest.className = 'status pass';
            });
            
            // Clipboard API Test
            const clipboardTest = document.getElementById('clipboard-test');
            if (navigator.clipboard) {
                try {
                    await navigator.clipboard.writeText('test');
                    clipboardTest.textContent = 'Pass';
                    clipboardTest.className = 'status pass';
                } catch {
                    clipboardTest.textContent = 'Permission Denied';
                    clipboardTest.className = 'status pending';
                }
            } else {
                clipboardTest.textContent = 'Not Supported';
                clipboardTest.className = 'status fail';
            }
            
            // Language Detection Test
            const langTest = document.getElementById('lang-test');
            if (navigator.language) {
                langTest.textContent = 'Pass (' + navigator.language + ')';
                langTest.className = 'status pass';
            } else {
                langTest.textContent = 'Fail';
                langTest.className = 'status fail';
            }
            
            // Responsive Layout Test
            const responsiveTest = document.getElementById('responsive-test');
            if (window.innerWidth <= 600) {
                responsiveTest.textContent = 'Mobile View';
                responsiveTest.className = 'status pass';
            } else {
                responsiveTest.textContent = 'Desktop View';
                responsiveTest.className = 'status pass';
            }
            
            // Touch Target Test
            const touchTargetTest = document.getElementById('touch-target-test');
            touchTargetTest.textContent = 'Manual Check Required';
            touchTargetTest.className = 'status pending';
            
            // Summary
            const passed = document.querySelectorAll('.status.pass').length;
            const failed = document.querySelectorAll('.status.fail').length;
            const pending = document.querySelectorAll('.status.pending').length;
            
            document.getElementById('summary').innerHTML = `
                <p><strong>Passed:</strong> ${passed}</p>
                <p><strong>Failed:</strong> ${failed}</p>
                <p><strong>Pending:</strong> ${pending}</p>
                <p><strong>Overall:</strong> ${passed >= 5 ? '✅ Ready for production' : '⚠️ Some issues to address'}</p>
            `;
        }
        
        function testOfflineMode() {
            if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
                // Simulate offline
                alert('Switch to Airplane Mode and refresh the page to test offline functionality');
            } else {
                alert('Service Worker not active. Open the app first to register it.');
            }
        }
        
        function testInstallPrompt() {
            alert('Install prompt appears automatically when:\n1. Site is served over HTTPS\n2. Has valid manifest.json\n3. Has registered service worker\n4. User has engaged with the site');
        }
        
        function openApp() {
            window.open('/src/ultimate-hotel-review-generator.html', '_blank');
        }
        
        // Auto-run tests on load
        setTimeout(runAllTests, 1000);
    </script>
</body>
</html>