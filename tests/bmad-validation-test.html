<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMAD Implementation Validation Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-header {
            background: #1e40af;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .pass {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }
        .fail {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }
        .pending {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .metric-card {
            background: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #1e40af;
        }
        .metric-label {
            color: #6b7280;
            font-size: 14px;
            margin-top: 5px;
        }
        button {
            background: #1e40af;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #1e3a8a;
        }
        .iframe-container {
            width: 100%;
            height: 600px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            margin-top: 20px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <div class="test-header">
        <h1>üîç BMAD Implementation Validation Suite</h1>
        <p>Comprehensive testing based on BMAD artifacts and requirements</p>
    </div>

    <div class="test-section">
        <h2>üìä Test Summary</h2>
        <div class="metrics">
            <div class="metric-card">
                <div class="metric-value" id="total-tests">0</div>
                <div class="metric-label">Total Tests</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="passed-tests">0</div>
                <div class="metric-label">Passed</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="failed-tests">0</div>
                <div class="metric-label">Failed</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="pass-rate">0%</div>
                <div class="metric-label">Pass Rate</div>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>üéØ Core Functionality Tests</h2>
        <button onclick="runCoreTests()">Run Core Tests</button>
        <div id="core-results"></div>
    </div>

    <div class="test-section">
        <h2>üì± Mobile Experience Tests</h2>
        <button onclick="runMobileTests()">Run Mobile Tests</button>
        <div id="mobile-results"></div>
    </div>

    <div class="test-section">
        <h2>‚ö° Performance Tests</h2>
        <button onclick="runPerformanceTests()">Run Performance Tests</button>
        <div id="performance-results"></div>
    </div>

    <div class="test-section">
        <h2>‚ôø Accessibility Tests</h2>
        <button onclick="runAccessibilityTests()">Run Accessibility Tests</button>
        <div id="accessibility-results"></div>
    </div>

    <div class="test-section">
        <h2>üåê Platform Routing Tests</h2>
        <button onclick="runPlatformTests()">Run Platform Tests</button>
        <div id="platform-results"></div>
    </div>

    <div class="test-section">
        <h2>üìà Analytics Integration Tests</h2>
        <button onclick="runAnalyticsTests()">Run Analytics Tests</button>
        <div id="analytics-results"></div>
    </div>

    <div class="test-section">
        <h2>üîß Manual Testing Interface</h2>
        <button onclick="loadApp()">Load Application</button>
        <button onclick="runAllTests()">Run All Tests</button>
        <div class="iframe-container">
            <iframe id="app-frame" src=""></iframe>
        </div>
    </div>

    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0
        };

        function updateMetrics() {
            document.getElementById('total-tests').textContent = testResults.total;
            document.getElementById('passed-tests').textContent = testResults.passed;
            document.getElementById('failed-tests').textContent = testResults.failed;
            const passRate = testResults.total > 0 ? Math.round((testResults.passed / testResults.total) * 100) : 0;
            document.getElementById('pass-rate').textContent = passRate + '%';
        }

        function addTestResult(container, name, passed, details = '') {
            testResults.total++;
            if (passed) testResults.passed++;
            else testResults.failed++;
            
            const result = document.createElement('div');
            result.className = `test-result ${passed ? 'pass' : 'fail'}`;
            result.innerHTML = `
                <strong>${passed ? '‚úÖ' : '‚ùå'} ${name}</strong>
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            container.appendChild(result);
            updateMetrics();
        }

        function loadApp() {
            const iframe = document.getElementById('app-frame');
            iframe.src = '../src/ultimate-hotel-review-generator.html';
        }

        async function runCoreTests() {
            const container = document.getElementById('core-results');
            container.innerHTML = '';
            
            // Test 1: Check if app loads
            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                addTestResult(container, 'Application loads successfully', response.ok, `Status: ${response.status}`);
            } catch (error) {
                addTestResult(container, 'Application loads successfully', false, error.message);
            }

            // Test 2: Check HTML structure
            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                const hasForm = html.includes('form') || html.includes('review-form');
                addTestResult(container, 'Review form exists', hasForm);
                
                const hasLanguageSelector = html.includes('language-selector');
                addTestResult(container, 'Language selector implemented', hasLanguageSelector);
                
                const hasMobileViewport = html.includes('viewport-fit=cover');
                addTestResult(container, 'Mobile viewport configured', hasMobileViewport);
            } catch (error) {
                addTestResult(container, 'HTML structure check', false, error.message);
            }

            // Test 3: Check PWA support
            try {
                const response = await fetch('../manifest.json');
                addTestResult(container, 'PWA manifest exists', response.ok);
            } catch (error) {
                addTestResult(container, 'PWA manifest exists', false);
            }

            // Test 4: Service Worker
            try {
                const response = await fetch('../sw.js');
                addTestResult(container, 'Service Worker implemented', response.ok);
            } catch (error) {
                addTestResult(container, 'Service Worker implemented', false);
            }
        }

        async function runMobileTests() {
            const container = document.getElementById('mobile-results');
            container.innerHTML = '';

            // Test mobile meta tags
            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                
                const hasMobileViewport = html.includes('width=device-width');
                addTestResult(container, 'Mobile viewport meta tag', hasMobileViewport);
                
                const hasThemeColor = html.includes('theme-color');
                addTestResult(container, 'Theme color for mobile browsers', hasThemeColor);
                
                const hasAppleCapable = html.includes('apple-mobile-web-app-capable');
                addTestResult(container, 'iOS web app capable', hasAppleCapable);
                
                const hasTouchTargets = html.includes('--touch-target: 48px');
                addTestResult(container, '48px touch targets defined', hasTouchTargets);
                
                const hasNoZoom = html.includes('user-scalable=no');
                addTestResult(container, 'Prevents unwanted zoom', hasNoZoom);
            } catch (error) {
                addTestResult(container, 'Mobile configuration', false, error.message);
            }
        }

        async function runPerformanceTests() {
            const container = document.getElementById('performance-results');
            container.innerHTML = '';

            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                const sizeKB = (html.length / 1024).toFixed(2);
                
                addTestResult(container, 'HTML size check', sizeKB < 100, `Size: ${sizeKB}KB (Target: <100KB)`);
                
                const hasLazyLoading = html.includes('loading="lazy"') || html.includes('lazy');
                addTestResult(container, 'Lazy loading implementation', hasLazyLoading);
                
                const hasCSP = html.includes('Content-Security-Policy');
                addTestResult(container, 'Content Security Policy', hasCSP);
                
                const hasPreload = html.includes('rel="preload"') || html.includes('rel="prefetch"');
                addTestResult(container, 'Resource preloading', hasPreload);
            } catch (error) {
                addTestResult(container, 'Performance checks', false, error.message);
            }
        }

        async function runAccessibilityTests() {
            const container = document.getElementById('accessibility-results');
            container.innerHTML = '';

            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                
                const hasAriaLabels = html.includes('aria-label');
                addTestResult(container, 'ARIA labels present', hasAriaLabels);
                
                const hasSemanticHTML = html.includes('<main') || html.includes('<header') || html.includes('<nav');
                addTestResult(container, 'Semantic HTML elements', hasSemanticHTML);
                
                const hasAltText = html.includes('alt=') || !html.includes('<img');
                addTestResult(container, 'Image alt text', hasAltText);
                
                const hasFocusStyles = html.includes(':focus');
                addTestResult(container, 'Focus styles defined', hasFocusStyles);
                
                const hasLangAttribute = html.includes('lang="');
                addTestResult(container, 'Language attribute set', hasLangAttribute);
            } catch (error) {
                addTestResult(container, 'Accessibility checks', false, error.message);
            }
        }

        async function runPlatformTests() {
            const container = document.getElementById('platform-results');
            container.innerHTML = '';

            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                
                const hasBooking = html.includes('booking.com') || html.includes('Booking');
                addTestResult(container, 'Booking.com integration', hasBooking);
                
                const hasTripAdvisor = html.includes('tripadvisor') || html.includes('TripAdvisor');
                addTestResult(container, 'TripAdvisor integration', hasTripAdvisor);
                
                const hasGoogle = html.includes('google') || html.includes('Google Maps');
                addTestResult(container, 'Google Maps integration', hasGoogle);
                
                const hasPlatformRouter = html.includes('PlatformRouter') || html.includes('platform');
                addTestResult(container, 'Platform routing logic', hasPlatformRouter);
            } catch (error) {
                addTestResult(container, 'Platform integration', false, error.message);
            }
        }

        async function runAnalyticsTests() {
            const container = document.getElementById('analytics-results');
            container.innerHTML = '';

            try {
                const response = await fetch('../src/ultimate-hotel-review-generator.html');
                const html = await response.text();
                
                const hasGA = html.includes('googletagmanager') || html.includes('gtag');
                addTestResult(container, 'Google Analytics integration', hasGA);
                
                const hasEventTracking = html.includes('trackEvent') || html.includes('analytics.track');
                addTestResult(container, 'Event tracking implementation', hasEventTracking);
                
                const hasConversionTracking = html.includes('conversion') || html.includes('submit');
                addTestResult(container, 'Conversion tracking', hasConversionTracking);
                
                const hasErrorTracking = html.includes('error') && html.includes('track');
                addTestResult(container, 'Error tracking', hasErrorTracking);
            } catch (error) {
                addTestResult(container, 'Analytics checks', false, error.message);
            }
        }

        async function runAllTests() {
            // Reset metrics
            testResults = { total: 0, passed: 0, failed: 0 };
            updateMetrics();
            
            // Run all test suites
            await runCoreTests();
            await runMobileTests();
            await runPerformanceTests();
            await runAccessibilityTests();
            await runPlatformTests();
            await runAnalyticsTests();
        }

        // Auto-load app on page load
        window.addEventListener('DOMContentLoaded', () => {
            updateMetrics();
        });
    </script>
</body>
</html>